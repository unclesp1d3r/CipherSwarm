<div id="<%= helpers.dom_id(agent) %>">
  <%= helpers.turbo_stream_from agent %>

  <%= render Railsboot::CardComponent.new(class: card_classes) do |card| %>
    <% card.with_header do %>
      <div class="d-flex justify-content-between align-items-center">
        <h5 class="mb-0"><%= agent.name %></h5>
        <span class="badge rounded-pill text-bg-<%= status_badge_variant %>">
          <%= agent.state.humanize %>
        </span>
      </div>
    <% end %>

    <% card.with_body do %>
      <div class="mb-2">
        <%= helpers.icon("speedometer2") %>
        <strong>Hash Rate:</strong> <%= agent.hash_rate_display %>
      </div>

      <div class="mb-2 <%= "text-danger" if error_count_last_24h.positive? %>">
        <%= helpers.icon("exclamation-triangle-fill") %>
        <strong>Errors (24h):</strong> <%= error_count_last_24h %>
      </div>

      <div class="mb-0">
        <%= helpers.icon("clock") %>
        <strong>Last Seen:</strong>
        <% if agent.last_seen_at.present? %>
          <%= helpers.time_ago_in_words(agent.last_seen_at) %> ago
        <% else %>
          Not seen yet
        <% end %>
      </div>
    <% end %>

    <% card.with_footer do %>
      <%= render Railsboot::ButtonGroupComponent.new(size: "sm") do |group| %>
        <%= helpers.link_to agent, class: "btn btn-sm btn-primary", title: "View Agent", "aria-label": "View Agent" do %>
          <%= helpers.icon("eye") %>
        <% end %>

        <%= helpers.link_to helpers.edit_agent_path(agent), class: "btn btn-sm btn-warning", title: "Edit Agent", "aria-label": "Edit Agent" do %>
          <%= helpers.icon("pencil") %>
        <% end %>

        <%= helpers.button_to agent,
                          method: :delete,
                          class: "btn btn-sm btn-danger",
                          title: "Delete Agent",
                          "aria-label": "Delete Agent",
                          data: { turbo_confirm: "Are you sure you want to delete this agent?" } do %>
          <%= helpers.icon("trash") %>
        <% end %>
      <% end %>
    <% end %>
  <% end %>
</div>
