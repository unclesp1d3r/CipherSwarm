<div id="<%= helpers.dom_id(agent) %>">
  <%= helpers.turbo_stream_from agent %>

  <%= render Railsboot::CardComponent.new(class: card_classes) do |card| %>
    <% card.with_header do %>
      <div class="d-flex justify-content-between align-items-center">
        <h5 class="mb-0">
          <a href="<%= helpers.agent_path(agent) %>" class="text-decoration-none text-reset" data-turbo-frame="_top">
            <%= agent.name %>
          </a>
        </h5>
        <%= render StatusPillComponent.new(status: agent.state) %>
      </div>
    <% end %>

    <% card.with_body do %>
      <div class="mb-2">
        <%= helpers.icon("speedometer2") %>
        <strong>Hash Rate:</strong> <%= agent.hash_rate_display %>
      </div>

      <div class="mb-2 <%= "text-danger" if error_count_last_24h.positive? %>">
        <%= helpers.icon("exclamation-triangle-fill") %>
        <strong>Errors (24h):</strong> <%= error_count_last_24h %>
      </div>

      <div class="mb-0">
        <%= helpers.icon("clock") %>
        <strong>Last Seen:</strong>
        <% if agent.last_seen_at.present? %>
          <%= helpers.time_ago_in_words(agent.last_seen_at) %> ago
        <% else %>
          Not seen yet
        <% end %>
      </div>
    <% end %>

    <% card.with_footer do %>
      <%= render Railsboot::ButtonGroupComponent.new(size: "sm") do |group| %>
        <% if helpers.can?(:read, agent) %>
          <a href="<%= helpers.agent_path(agent) %>" class="btn btn-sm btn-primary" title="View Agent" aria-label="View Agent" data-turbo-frame="_top">
            <i class="bi bi-eye"></i>
          </a>
        <% end %>

        <% if helpers.can?(:update, agent) %>
          <a href="<%= helpers.edit_agent_path(agent) %>" class="btn btn-sm btn-warning" title="Edit Agent" aria-label="Edit Agent" data-turbo-frame="_top">
            <i class="bi bi-pencil"></i>
          </a>
        <% end %>

        <% if helpers.can?(:destroy, agent) %>
          <form action="<%= helpers.agent_path(agent) %>" method="post" class="d-inline" data-turbo-frame="_top" data-turbo-confirm="Are you sure you want to delete this agent?">
            <input type="hidden" name="_method" value="delete" autocomplete="off">
            <input type="hidden" name="authenticity_token" value="<%= helpers.form_authenticity_token %>" autocomplete="off">
            <button type="submit" class="btn btn-sm btn-danger" title="Delete Agent" aria-label="Delete Agent">
              <i class="bi bi-trash"></i>
            </button>
          </form>
        <% end %>
      <% end %>
    <% end %>
  <% end %>
</div>
