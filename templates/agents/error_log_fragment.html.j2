{# Agent Error Log Fragment - for HTMX swaps #}
{% if errors and errors|length > 0 %}
<div class="overflow-x-auto">
    <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
            <tr>
                <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Time</th>
                <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Severity</th>
                <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Message</th>
                <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Task</th>
                <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Error Code
                </th>
            </tr>
        </thead>
        <tbody class="bg-white divide-y divide-gray-200">
            {% for error in errors %}
            <tr>
                <td class="px-4 py-2 whitespace-nowrap text-xs text-gray-500">{{ error.created_at.strftime('%Y-%m-%d
                    %H:%M:%S') if error.created_at else '' }}</td>
                <td class="px-4 py-2 whitespace-nowrap">
                    {% set sev = error.severity.value if error.severity is not string and error.severity.value is
                    defined else error.severity %}
                    {% if sev == 'minor' %}
                    <span
                        class="inline-block rounded px-2 py-1 text-xs font-semibold text-yellow-800 bg-yellow-100">Minor</span>
                    {% elif sev == 'critical' %}
                    <span
                        class="inline-block rounded px-2 py-1 text-xs font-semibold text-red-800 bg-red-100">Critical</span>
                    {% else %}
                    <span
                        class="inline-block rounded px-2 py-1 text-xs font-semibold text-gray-800 bg-gray-100">Info</span>
                    {% endif %}
                </td>
                <td class="px-4 py-2 text-xs text-gray-900">{{ error.message|e }}</td>
                <td class="px-4 py-2 text-xs text-gray-500">{% if error.task_id %}#{{ error.task_id }}{% else %}-{%
                    endif %}</td>
                <td class="px-4 py-2 text-xs text-gray-500">{{ error.error_code or '-' }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% else %}
<div class="text-gray-400 text-sm italic py-4">No errors reported for this agent.</div>
{% endif %}