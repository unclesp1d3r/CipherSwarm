{% extends "base.html.j2" %}

{% block content %}
<div class="container mx-auto py-8 max-w-4xl">
    <div class="flex justify-between items-center mb-4">
        <h1 class="text-2xl font-bold">Attacks</h1>
        <button class="text-white bg-blue-700 hover:bg-blue-800 font-medium rounded-lg text-sm px-5 py-2.5"
            hx-get="/attacks/editor-modal" hx-target="#modal-container" hx-trigger="click">
            New Attack
        </button>
    </div>
    <form method="get" class="mb-4 flex gap-2">
        <input type="text" name="q" value="{{ q or '' }}" placeholder="Search attacks..." class="form-input w-64" />
        <button type="submit" class="btn btn-outline">Search</button>
    </form>
    <div class="overflow-x-auto rounded-lg shadow">
        <table class="min-w-full divide-y divide-gray-200">
            <thead class="bg-gray-50 dark:bg-gray-700">
                <tr>
                    <th class="px-4 py-2">Name</th>
                    <th class="px-4 py-2">Type</th>
                    <th class="px-4 py-2">Length</th>
                    <th class="px-4 py-2">Settings</th>
                    <th class="px-4 py-2">Keyspace</th>
                    <th class="px-4 py-2">Complexity</th>
                    <th class="px-4 py-2">Comment</th>
                    <th class="px-4 py-2">Actions</th>
                </tr>
            </thead>
            <tbody id="attack-list-body"
                hx-get="/api/v1/web/attacks?page={{ page }}&size={{ size }}{% if q %}&q={{ q }}{% endif %}"
                hx-trigger="load" hx-target="this" hx-swap="outerHTML">
                {% include "attacks/attack_table_body.html.j2" %}
            </tbody>
        </table>
    </div>
    <div class="flex justify-between items-center mt-4">
        <div>
            Showing page {{ page }} of {{ total_pages }} ({{ total }} total)
        </div>
        <div class="flex gap-2">
            {% if page > 1 %}
            <a href="?page={{ page - 1 }}&size={{ size }}{% if q %}&q={{ q }}{% endif %}"
                class="btn btn-outline">Previous</a>
            {% endif %}
            {% if page < total_pages %} <a href="?page={{ page + 1 }}&size={{ size }}{% if q %}&q={{ q }}{% endif %}"
                class="btn btn-outline">Next</a>
                {% endif %}
        </div>
    </div>
    <div id="modal-container"></div>
</div>
{% endblock %}